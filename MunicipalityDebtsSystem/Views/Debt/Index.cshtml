
@{
    ViewData["Title"] = "Списък с дългове";
}

<h1 class="smart-title">@ViewData["Title"]</h1>

<table id="debtTable" class="display">
    <thead>
        <tr>
            <th></th>
            <th>Номер на договор/анекс</th>
            <th>Към договор№</th>
            <th>Решение №</th>
            <th>Дата на поемане на дълг</th>
            <th>Крайна дата на дълг</th>
            <th>Размер на дълга в оригинална валута</th>
            <th>Валута</th>
            <th>Община</th>
            <th>Код</th>
            <th>Статус</th>
            <th></th> @* Предоговаряне, Изтриване от Details *@
            <th></th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<!-- DataTables JS and jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script>

    $(document).ready(function () {
        $('#debtTable').DataTable({
            // processing: true,
            serverSide: true,
            ajax: {
                url: '@Url.Action("GetDebtsForDataTable", "Debt")', // Ensure this URL matches your controller route
                type: 'GET',  // Explicitly set method to POST
                contentType: 'application/json',  // Specify content type as JSON
                data: function (d) {
                    ////Modify the data being sent to the server
                    // return JSON.stringify({
                    //     draw: d.draw,
                    //     start: d.start,
                    //     length: d.length,
                    //     searchValue: d.search.value  // Add any additional filters
                    // });
                    return {
                        draw: d.draw,
                        start: d.start,
                        length: d.length,
                        searchValue: d.search.value  // Add any additional filters
                    };
                },
                dataSrc: function (json) {
                    return json.data;
                },
                error: function (xhr, error, code) {
                    console.error("Error:", error, code);
                }
            },
            columns: [
                {
                    data: 'id',
                    // title: '№',
                    // sortable: true,
                    // searchable: true,
                    //visible = false
                },
                { data: 'debtNumber' },
                { data: 'debtParentNumber' },
                { data: 'resolutionNumber' },
                { data: 'dateBook' },
                { data: 'dateContractFinish' },
                { data: 'debtAmountOriginalCcy' },
                { data: 'currencyName' },
                { data: 'municipalityName' },
                { data: 'municipalityCode' },
                { data: 'statusName' },
                {
                    data: "details",
                    data: function (a) {
                        return "<a href = '/Debt/Details/" + a.id + "' target=' _parent' class = 'btn btn-info btn-sm' role = 'button'>Преглед</a>"
                    }
                },
                {
                    data: "edit",
                    data: function (a) {
                        return "<a href = '/Debt/Edit/" + a.id + "' target=' _parent' class = 'btn btn-info btn-sm' role = 'button'>Редактиране</a>"
                    }
                },

            ],

            // Pagination and ordering settings
            pageLength: 10, // Show 10 records per page
            lengthMenu: [10, 25, 50, 100], // Options for records per page
            order: [[4, 'asc']], // Default ordering by 'dateBook' column (4th)
            responsive: true, // Enable responsive design
            language: {
                search: "Търсене:",
                lengthMenu: "Показване на _MENU_ реда на страница",
                info: "Показване на _START_ до _END_ от _TOTAL_ реда",
                infoEmpty: "Няма данни за показване",
                infoFiltered: "(филтрирани от _MAX_ общо реда)",
                paginate: {
                    next: "Следваща",
                    previous: "Предишна"
                }
            }



        });
    });
</script>



<style>
    .smart-title {
        font-family: 'Segoe UI', sans-serif;
        font-size: 2.5rem;
        font-weight: 600;
        color: #4A90E2;
        background: linear-gradient(135deg, #4A90E2, #5C6BC0);
        -webkit-background-clip: text;
        background-clip: text;
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.15);
        display: inline-block;
        padding-bottom: 5px;
    }

    table.dataTable {
        width: 100%;
        margin: 20px 0;
        border-collapse: collapse;
    }

        table.dataTable th,
        table.dataTable td {
            text-align: left;
            padding: 8px;
        }

        table.dataTable th {
            background-color: #f1f1f1;
            font-weight: bold;
        }

        table.dataTable tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }

    .btn {
        font-size: 12px;
        padding: 6px 12px;
        margin-right: 5px;
        text-align: center;
    }

    .btn-info {
        background-color: #17a2b8;
        border-color: #17a2b8;
    }

    .btn-warning {
        background-color: #ffc107;
        border-color: #ffc107;
    }

    .btn-sm {
        padding: 5px 10px;
    }
</style>
